<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Make User Admin</title>
</head>
<body>
    <h1>Make this user an admin</h1>
    <p>Open the console to see the result.</p>
    <button id="makeAdminBtn">Make me admin</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, connectAuthEmulator } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-auth.js";
        import { getFunctions, httpsCallable, connectFunctionsEmulator } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-functions.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBYjq_CaTEfFhfTChfJ6SnXSbgIzbbRHHc",
            authDomain: "rollingtranslationsportal.firebaseapp.com",
            projectId: "rollingtranslationsportal",
            storageBucket: "rollingtranslationsportal.firebasestorage.app",
            messagingSenderId: "492156326175",
            appId: "1:492156326175:web:14175badae2bbaada0e02a"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const functions = getFunctions(app, "us-central1");

        // Using production for makeUserAdmin function
        // if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
        //     connectAuthEmulator(auth, 'http://localhost:9099');
        //     connectFunctionsEmulator(functions, 'localhost', 5001);
        //     console.log('Connected to emulators for makeUserAdmin');
        // }

        const makeUserAdmin = httpsCallable(functions, 'makeUserAdmin');

        document.getElementById('makeAdminBtn').addEventListener('click', async () => {
            try {
                const email = prompt("Enter your admin email:");
                const password = prompt("Enter your admin password:");
                if (!email || !password) {
                    alert("Email and password are required.");
                    return;
                }

                await signInWithEmailAndPassword(auth, email, password);
                console.log("Signed in successfully.");

                const uidToMakeAdmin = 'TuFPXc6JlZaItnO2KAxvWP0sRwZ2'; 

                const result = await makeUserAdmin({ uid: uidToMakeAdmin });
                console.log(result.data.message);
                alert(result.data.message);
            } catch (error) {
                console.error("Error calling function:", error);
                alert("Failed to make user admin: " + error.message);
            }
        });
    </script>
</body>
</html>